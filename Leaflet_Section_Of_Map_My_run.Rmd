---
title: "Leaflet_Section_of_Map_My_Run"
output: html_document
---

So I only need the count_all_coords_2 file to continue from here. I mean, also 
the all_coords is needed for when I redo my rounding. But moving forward with
leaflet, I would only be using that one csv. 

I need to use a chloropeth. 

```{r}
library(tidyverse)
library(leaflet)
count_all_coords <- read_csv(
  "All_coordinates_rounded_and_filtered_only_Bmore.csv")
```

Maybe a good thing would be to visualize the range of the data that we have. 

```{r}
ggplot(count_all_coords, aes(n)) +
  geom_histogram(binwidth = 1, center= 0.5)+
  coord_cartesian(xlim =c(0,100))

ggplot(count_all_coords, aes(Log_n)) +
  geom_histogram(binwidth = .25, center=0.125)
```


```{r}


count_all_coords %>%
  group_by(n) %>%
  summarise(yo=n())
```

The current range of the data is 1-600 or so.

I do not think I need to bin it, instead use it as continuous. I can use the 
colorNumeric function to turn continuous numeric data into colors. But I need to 
choose a palette. Possible ones are "viridis palettes", RColorBrewer palettes

```{r}
#now I need to turn continuous data into a color palette. 
color_palette <- colorNumeric("plasma", domain = count_all_coords$n)

count_all_coords <- count_all_coords %>%
  mutate(Color = color_palette(n))

#Try to do Log instead. 
count_all_coords <- count_all_coords %>%
  mutate(Log_n = log10(count_all_coords$n))

log_color_palette <- colorNumeric("viridis", domain = count_all_coords$Log_n)

count_all_coords <- count_all_coords %>%
  mutate(log_Color = log_color_palette(Log_n))

#Could try 
```

Now I want to add those colors to the map
```{r}

#practice with leaflet

m=leaflet()

m=addTiles(m, urlTemplate = "http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png")

count_all_coords_practice <- count_all_coords[seq(1,nrow(count_all_coords),10),]

#addPolygons doen't work, they're too big. 
m %>%
  addCircles(count_all_coords$lon, count_all_coords$lat, 
              color = count_all_coords$log_Color)

m
```


The addTiles function is part of addControl, which is about adding graphic 
elements and layers. You can addPopups, addMarkers, addCircles, addPolylines, addRectangles, addPolygons.

What is geoJSON? 
It is a 
["format 4 encoding variety of geographic data structures"](http://geojson.org/)

What is JSON? It is a 
[lightweight data-interchange format](https://www.json.org/) It has objects, 
which are name/value pairs, and it has an ordered list of values. 

JSON stands for 
[Java Script Object Notation](https://www.w3schools.com/js/js_json_intro.asp). 
Really the reason, when you exchange data, it has to be in text. JSON is text. 
We can convert any javasrcipt object into JSON, and vice versa. 

A Javascript object is one of the seven basic data types. Unlike the other data
types (numbers, strings, boolean, null, undefined (except for symbol)), which 
are primitive, meaning they can only hold one type of thing, the object can
contain complex data collections.

